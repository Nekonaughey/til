●大きい集約の問題点
モデリングは簡単ですが、この場合、実用に耐えません。
複数のユーザーが同時に操作した場合に、トランザクションが衝突する可能性がとても高いためです。
通常、エンティティの実装を行う場合、楽観的並行性制御と呼ばれる手法がよく用いられます。

この手法では、エンティティがバージョン番号を保持しており、なんらかの変更を行うたびにバージョン番号を加算していきます。

もし別のユーザーが集約を更新済みの場合、想定しているバージョン番号と異なるので、後から更新しようとしたユーザーがエラーとなります。
そのため別のユーザーに更新された後の最新値を取得して、更新処理をやり直す必要があります。

WINGSプロジェクト青木淳夫.「実践ドメイン駆動設計」から学ぶDDDの実装入門CodeZineDigitalFirst(Kindleの位置No.2156-2162).株式会社翔泳社.Kindle版.
